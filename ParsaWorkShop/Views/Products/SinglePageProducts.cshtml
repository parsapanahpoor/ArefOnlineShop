@model Domain.ViewModels.SiteSide.Product.ProductDetailSiteSideViewModel
@{
    ViewData["Title"] = Model.ProductTitle;
}


<section class="bg-half bg-light d-table w-100">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-12 text-center">
                <div class="page-next-level">
                    <h4 class="title"> @Model.ProductTitle </h4>
                    <div class="page-next">
                        <nav aria-label="breadcrumb" class="d-inline-block">
                            <ul class="breadcrumb bg-white rounded shadow mb-0">
                                <li class="breadcrumb-item"><a href="/">فروشگاه کالا </a></li>
                                <li class="breadcrumb-item"><a href="/Products">فروشگاه </a></li>
                                <li class="breadcrumb-item active" aria-current="page"> محصول </li>
                            </ul>
                        </nav>
                    </div>
                </div>
            </div><!--end col-->
        </div><!--end row-->
    </div> <!--end container-->
</section>

<div class="position-relative">
    <div class="shape overflow-hidden text-white">
        <svg viewBox="0 0 2880 48" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M0 48H1437.5H2880V0H2160C1442.5 52 720 0 720 0H0V48Z" fill="currentColor"></path>
        </svg>
    </div>
</div>

<section class="section pb-0">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-md-5">
                <div class="tns-outer" id="tns1-ow">
                    <div class="tns-liveregion tns-visually-hidden" aria-live="polite" aria-atomic="true">slide <span class="current">2</span>  of 5</div><div id="tns1-mw" class="tns-ovh">
                        <div class="tns-inner" id="tns1-iw">
                            <div class="tiny-single-item  tns-slider tns-carousel tns-subpixel tns-calc tns-horizontal" id="tns1" style="transform: translate3d(-20%, 0px, 0px);">
                                <div class="tiny-slide tns-item tns-slide-active" id="tns1-item1"><img src="/Images/Product/image/@Model.ProductImageName" class="img-fluid rounded" alt=""></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div><!--end col-->

            <div class="col-md-7 mt-4 mt-sm-0 pt-2 pt-sm-0">
                <div class="section-title ms-md-4">
                    <h4 class="title">@Model.ProductTitle</h4>
                    @if (Model.IsInOffer == true)
                    {
                        <h5 class="text-muted">
                            <del style=" color:red;">
                                @Model.OldPrice.Value.ToString("#,0") تومان
                            </del>
                      </h5>

                    }
                    <h5 class="text-muted">@Model.Price.ToString("#,0") تومان  </h5>


                    <h5 class="mt-4 py-2">بررسی:</h5>
                    <p class="text-muted">
                        @Model.ShortDescription
                    </p>

                    <div class="row mt-4 pt-2">


                        <div class="col-lg-6 col-12 mt-4 mt-lg-0">
                            <div class="d-flex shop-list align-items-center">
                                <h6 class="mb-0">موجودی در انبار : </h6>
                                <div class="qty-icons ms-3">
                                    <dive min="0" name="quantity" value="0" type="number" class="btn btn-icon btn-soft-primary qty-btn quantity">@Model.ProductCount عدد
                                </div>
                            </div>
                        </div>
                    </div><!--end col-->
                </div><!--end row-->

                <div class="mt-4 pt-2">
                    <a href="/order/AddToShopCart/@Model.ProdcutId" class="btn btn-soft-primary ms-2">افزودن به سبد</a>
                </div> 
                
                @if (User.Identity.IsAuthenticated)
                {
                    @if (ViewBag.IsFavoriteProduct == true)
                    {
                        <div class="mt-4 pt-2">
                            <a asp-action="AddOrRemoveProductToTheFavorite" asp-area="" asp-controller="Products" asp-route-productId="@Model.ProdcutId" class="btn btn-soft-primary ms-2">حذف از علاقه مندی</a>
                        </div>
                    }
                    else
                    {
                        <div class="mt-4 pt-2">
                            <a asp-action="AddOrRemoveProductToTheFavorite" asp-area="" asp-controller="Products" asp-route-productId="@Model.ProdcutId" class="btn btn-soft-primary ms-2">افزودن به علاقه مندی</a>
                        </div>
                    }
                }
                else
                {
                    <div class="mt-4 pt-2">
                        <a asp-action="AddOrRemoveProductToTheFavorite" asp-area="" asp-controller="Products" asp-route-productId="@Model.ProdcutId" class="btn btn-soft-primary ms-2">افزودن به علاقه مندی</a>
                    </div>
                }
                
            </div>
        </div><!--end col-->
    </div><!--end row-->
    </div><!--end container-->

    <div class="container mt-100 mt-60">
        <div class="row">
            <div class="col-12">
                <ul class="nav nav-pills shadow flex-column flex-sm-row d-md-inline-flex mb-0 p-1 bg-white rounded position-relative overflow-hidden" id="pills-tab" role="tablist">
                    <li class="nav-item m-1">
                        <a class="nav-link py-2 px-5 active rounded" id="description-data" data-bs-toggle="pill" href="#description" role="tab" aria-controls="description" aria-selected="false">
                            <div class="text-center">
                                <h6 class="mb-0">اطلاعات تکمیلی</h6>
                            </div>
                        </a><!--end nav link-->
                    </li><!--end nav item-->

                    <li class="nav-item m-1">
                        <a class="nav-link py-2 px-5 rounded" id="additional-info" data-bs-toggle="pill" href="#additional" role="tab" aria-controls="additional" aria-selected="false">
                            <div class="text-center">
                                <h6 class="mb-0"> ویژگی ها </h6>
                            </div>
                        </a><!--end nav link-->
                    </li><!--end nav item-->

                    <li class="nav-item m-1">
                        <a class="nav-link py-2 px-5 rounded" id="review-comments" data-bs-toggle="pill" href="#review" role="tab" aria-controls="review" aria-selected="false">
                            <div class="text-center">
                                <h6 class="mb-0">نظرات </h6>
                            </div>
                        </a><!--end nav link-->
                    </li><!--end nav item-->
                </ul>

                <div class="tab-content mt-5" id="pills-tabContent">
                    <div class="card border-0 tab-pane fade show active" id="description" role="tabpanel" aria-labelledby="description-data">
                        <p class="text-muted mb-0">
                            @Html.Raw(Model.LongDescription)
                        </p>
                    </div>

                    <div class="card border-0 tab-pane fade" id="additional" role="tabpanel" aria-labelledby="additional-info">
                        <table class="table">
                            <tbody>
                                @foreach (var item in Model.ProductFeatures)
                                {
                                    <tr>
                                        <td>@item.FeatureTitle </td>
                                        <td class="text-muted">@item.FeatureValue</td>
                                    </tr>
                                }

                            </tbody>
                        </table>
                    </div>

                    <div class="card border-0 tab-pane fade" id="review" role="tabpanel" aria-labelledby="review-comments">
                        <div class="row">
                            <div class="col-lg-6">
                                <ul class="media-list list-unstyled mb-0" id="listComment">
                                </ul>
                            </div><!--end col-->
                            @if (User.Identity.IsAuthenticated)

                            {<div class="col-lg-6 mt-4 mt-lg-0 pt-2 pt-lg-0" id="commentProduct">

                                    <form class="ms-lg-4" asp-action="CreateCommente" asp-controller="Products"
                                          data-ajax="true"
                                          data-ajax-method="post"
                                          data-ajax-mode="replace"
                                          data-ajax-update="#listComment"
                                          data-ajax-success="Success"
                                          id="contactForm" method="POST">

                                        <input type="hidden" name="comment.ProductID" value="@Model.ProdcutId" />

                                        <div class="row">
                                            <div class="col-12">
                                                <h5>اضافه کردن نظر:</h5>
                                            </div>
                                            <div class="col-md-12 mt-3">
                                                <div class="mb-3">
                                                    <label class="form-label">نظر شما:</label>
                                                    <div class="form-icon position-relative">
                                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-message-circle fea icon-sm icons"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path></svg>
                                                        <textarea id="Comment" placeholder="کامنت شما" rows="5" name="comment.CommentBody" class="form-control ps-5" required=""></textarea>
                                                    </div>
                                                </div>
                                            </div><!--end col-->

                                            <div class="col-lg-12">
                                                <div class="mb-3">
                                                    <label class="form-label">نام  <span class="text-danger">*</span></label>
                                                    <div class="form-icon position-relative">
                                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-user fea icon-sm icons"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
                                                        <div id="name" readonly type="text" placeholder="نام" class="form-control ps-5" required="">@User.Identity.Name </div>

                                                    </div>
                                                </div>
                                            </div><!--end col-->



                                            <div class="col-md-12">
                                                <div class="send d-grid">
                                                    <button type="submit" class="btn btn-primary">ارسال </button>
                                                </div>
                                            </div><!--end col-->
                                        </div><!--end row-->
                                    </form>

                                </div><!--end col-->


                            }
                            @if (!User.Identity.IsAuthenticated)
                            {

                                <div class="alert alert-danger">
                                    جهت درج نظر باید وارد سایت شوید
                                </div>

                            }
                        </div><!--end row-->
                    </div>
                </div>
            </div>
        </div>
    </div><!--end container-->
    <section class="section mt-0 pt-0">
        <div class="container mt-100 mt-60">
            <div class="row">
                <div class="col-12">
                    <h5 class="mb-0">محصولات اخیر</h5>
                </div><!--end col-->

                @await Component.InvokeAsync("Lastest4ProductsLargSizeComponent")

            </div><!--end row-->
        </div><!--end container-->
    </section>
</section>


@section Scripts
    {
    <script src="~/js/jquery.min.js"></script>
    <script src="~/js/jquery.unobtrusive-ajax.min.js"></script>
    <script>
        function Success() {
            $("#comment_Comment").val("");
        }

        $(function() {
            $("#listComment").load("/Products/ShowComment/" + @Model.ProdcutId);
        });

        function pageComment(pageid) {
            $("#listComment").load("/Products/ShowComment/" + @Model.ProdcutId+"?pageId=" + pageid);
        }
    </script>
}